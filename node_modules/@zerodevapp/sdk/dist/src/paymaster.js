"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.VerifyingPaymasterAPI = void 0;
const properties_1 = require("@ethersproject/properties");
const api_1 = require("./api");
const errors_1 = require("./errors");
const PaymasterAPI_1 = require("./PaymasterAPI");
const utils_1 = require("./utils");
class VerifyingPaymasterAPI extends PaymasterAPI_1.PaymasterAPI {
    constructor(projectId, paymasterUrl, chainId) {
        super();
        this.projectId = projectId;
        this.paymasterUrl = paymasterUrl;
        this.chainId = chainId;
    }
    async getPaymasterAndData(userOp) {
        const resolvedUserOp = await (0, properties_1.resolveProperties)(userOp);
        const hexifiedUserOp = (0, utils_1.hexifyUserOp)(resolvedUserOp);
        const paymasterAndData = await (0, api_1.signUserOp)(this.projectId, this.chainId, hexifiedUserOp, this.paymasterUrl);
        if (!paymasterAndData) {
            throw errors_1.ErrTransactionFailedGasChecks;
        }
        return paymasterAndData;
    }
}
exports.VerifyingPaymasterAPI = VerifyingPaymasterAPI;
//# sourceMappingURL=paymaster.js.map